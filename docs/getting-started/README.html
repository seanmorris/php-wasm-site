<!DOCTYPE HTML>

<head>
	<title>ReadMe</title>
	<script src = "/main.js"></script>
	<style>@import url('/heading.css'); </style>
	<style>@import url('/style.css'); </style>
	<style>@import url('/article.css'); </style>
	<style>@import url('/pandoc.css'); </style>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
	<title>ReadMe</title>
	<style>
		code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
  pre > code.sourceCode { white-space: pre; position: relative; }
  pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
  pre > code.sourceCode > span:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode > span { color: inherit; text-decoration: inherit; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  pre > code.sourceCode { white-space: pre-wrap; }
  pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
  }
  pre.numberSource code
    { counter-reset: source-line 0; }
  pre.numberSource code > span
    { position: relative; left: -4em; counter-increment: source-line; }
  pre.numberSource code > span > a:first-child::before
    { content: counter(source-line);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
    }
  pre.numberSource { margin-left: 3em;  padding-left: 4px; }
  div.sourceCode
    { color: #cccccc; background-color: #303030; }
  @media screen {
  pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
  }
  code span.al { color: #ffcfaf; } /* Alert */
  code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
  code span.at { } /* Attribute */
  code span.bn { color: #dca3a3; } /* BaseN */
  code span.bu { } /* BuiltIn */
  code span.cf { color: #f0dfaf; } /* ControlFlow */
  code span.ch { color: #dca3a3; } /* Char */
  code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
  code span.co { color: #7f9f7f; } /* Comment */
  code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
  code span.do { color: #7f9f7f; } /* Documentation */
  code span.dt { color: #dfdfbf; } /* DataType */
  code span.dv { color: #dcdccc; } /* DecVal */
  code span.er { color: #c3bf9f; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #c0bed1; } /* Float */
  code span.fu { color: #efef8f; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
  code span.kw { color: #f0dfaf; } /* Keyword */
  code span.op { color: #f0efd0; } /* Operator */
  code span.ot { color: #efef8f; } /* Other */
  code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
  code span.sc { color: #dca3a3; } /* SpecialChar */
  code span.ss { color: #cc9393; } /* SpecialString */
  code span.st { color: #cc9393; } /* String */
  code span.va { } /* Variable */
  code span.vs { color: #cc9393; } /* VerbatimString */
  code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
  .display.math{display: block; text-align: center; margin: 0.5rem auto;}
	</style>
	<link rel="stylesheet" href="ss" />
</head>

<body>
	<section class = "heading">
		<div class = "page-rule">
			<nav>
				<div class = "logo">
					<a href = "/index.html"><img src = "/logo-80.png"></a>
				</div>
				<ul class = "links">
					<li><a href = "/index.html">Home</a></li>
					<li><a href = "/getting-started/README.html">Docs</a></li>
					<li><a href = "/contact.html">Contact</a></li>
					<li>
						<a href = "https://github.com/seanmorris/php-wasm">Github</a>
						<a href = "https://github.com/seanmorris/php-wasm"><img src = "/github-icon.png"></a>
					</li>
					<li><a href = "https://github.com/sponsors/seanmorris" class = "cta button">Donate</a></li>
				</ul>
			</nav>
					</div>
	</section>

	<section class = "below-fold">
		<div class = "page-rule">
						<nav class = "main">
				<ul><details open><summary>Getting Started</summary><ul><li><a href = "/getting-started/README.html">ReadMe</a></li>
<li><a href = "/getting-started/php-in-static-html.html">Php In Static Html</a></li>
<li><a href = "/getting-started/cgi-in-nodeJs.html">Cgi In NodeJs</a></li>
<li><a href = "/getting-started/video-demo-test.html">Video Demo Test</a></li>
<li><a href = "/getting-started/cgi-service-worker.html">Cgi Service Worker</a></li>
</ul></details><details open><summary>Extensions</summary><ul><li><a href = "/extensions/using-php-extensions.html">Using Php Extensions</a></li>
<li><a href = "/extensions/pdo-pglite.html">Pdo Pglite</a></li>
<li><a href = "/extensions/vrzno.html">Vrzno</a></li>
<li><a href = "/extensions/pdo-cfd1.html">Pdo Cfd1</a></li>
</ul></details><details open><summary>Compiling</summary><ul><li><a href = "/compiling/building-in-place.html">Building In Place</a></li>
<li><a href = "/compiling/building-with-make.html">Building With Make</a></li>
</ul></details><details open><summary>Php Cgi</summary><ul><li><a href = "/php-cgi/node.html">Node</a></li>
<li><a href = "/php-cgi/service-worker.html">Service Worker</a></li>
</ul></details><li><a href = "/LICENSE.html">LICENSE</a></li>
</ul>
			</nav>
						<article><h1 id="php-wasm">php-wasm</h1>
<p><a href="https://www.npmjs.com/package/php-wasm"><img
src="https://img.shields.io/npm/v/php-wasm?color=4f5d95&amp;label=php-wasm&amp;style=for-the-badge"
alt="php-wasm" /></a> <a
href="https://github.com/seanmorris/php-wasm/blob/master/LICENSE"><img
src="https://img.shields.io/npm/l/cv3-inject?logo=apache&amp;color=427819&amp;style=for-the-badge"
alt="Apache-2.0 Licence Badge" /></a> <a
href="https://github.com/sponsors/seanmorris"><img
src="https://img.shields.io/github/sponsors/seanmorris?style=for-the-badge&amp;color=f1e05a"
alt="GitHub Sponsors" /></a> <img
src="https://img.shields.io/github/languages/code-size/seanmorris/php-wasm?color=e34c26&amp;logo=data%3Aimage%2Fpng%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAQAAACFzfR7AAABF0lEQVQoFQXBQWvOAQDA4ef/7o29YWtqKU7ExWE5OIvm4LKcnXwD7aQ0N/kAczO1i1KOO0xJvQojaTm4KbJabnJysLSf5wFAa603CUB322yOAAitVT86BTTQ1+oJDYDQcv+qFRr3vC1ooYPqDkHoYgfVKmnSfhG62t/qBkHn2q8ekjRpryB0v/rZ2eh4r6tpY5pp3Gx7RTONoJfVLnpQfekYtNG0832rRj3tEaT31bOxQ5wc/oATrnnniEMfXfaZDFrAoEk71XajNN9OVVW7HYVeVZ9AF/pd3YPm267qbYs0tF597wygpaquQ7Nt9QLoVlWXCEK3q1oCCF2p6iYBpKGN6kNzATrdr2qVAACa9rgRQKPetAnAf1jX/qSkN8aIAAAAAElFTkSuQmCC&amp;style=for-the-badge"
alt="Size" /> <img
src="https://img.shields.io/github/stars/seanmorris/php-wasm?style=for-the-badge&amp;label=GitHub%20Stars&amp;link=https%3A%2F%2Fgithub.com%2Fseanmorris%2Fphp-wasm"
alt="GitHub Repo stars" /> <img
src="https://img.shields.io/github/actions/workflow/status/seanmorris/php-wasm/test.yaml?style=for-the-badge"
alt="GitHub Actions Workflow Status" /> <img
src="https://img.shields.io/npm/dw/php-wasm?style=for-the-badge&amp;color=C80&amp;link=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fphp-wasm&amp;label=npm%20installs"
alt="NPM Downloads" /> <img
src="https://img.shields.io/jsdelivr/npm/hw/php-wasm?style=for-the-badge&amp;color=09D&amp;link=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fphp-wasm&amp;label=jsdelivr%20hits"
alt="jsDelivr hits (npm)" /> <a
href="https://www.reddit.com/r/phpwasm/"><img
src="https://img.shields.io/badge/reddit-always%20online-336699?style=for-the-badge&amp;logo=reddit"
alt="Static Badge" /></a> <a href="https://discord.gg/j8VZzju7gJ"><img
src="https://img.shields.io/discord/1199824765666463835?style=for-the-badge&amp;logo=discord&amp;link=https%3A%2F%2Fdiscord.gg%2Fj8VZzju7gJ"
alt="Discord" /></a></p>
<p><em>PHP in WebAssembly, npm not required.</em></p>
<h2 id="npm-github-unpkg-reddit-discord"><a
href="https://npmjs.com/package/php-wasm">npm</a> | <a
href="https://github.com/seanmorris/php-wasm">github</a> | <a
href="https://unpkg.com/browse/php-wasm/">unpkg</a> | <a
href="https://www.reddit.com/r/phpwasm">reddit</a> | <a
href="https://discord.gg/j8VZzju7gJ">discord</a></h2>
<h2 id="v0.0.9-alpha---aiming-for-the-github-stars">🌟 v0.0.9-alpha -
Aiming for the (GitHub) Stars</h2>
<ul>
<li>Adding PHP-CGI support!</li>
<li>Runtime extension loading!</li>
<li>libicu, freetype, zlib, gd, libpng, libjpeg, openssl, &amp; phar
support.</li>
<li>php-wasm, php-cgi-wasm, &amp; php-wasm-builder are now separate
packages.</li>
<li>Vrzno now facilitates url fopen via the fetch() api.</li>
<li><a href="https://github.com/seanmorris/pdo-cfd1">pdo_cfd1</a> is now
a separate extension from Vrzno.</li>
<li><a href="https://github.com/seanmorris/pdo-pglite">pdo_pglite</a>
adds local Postgres support.</li>
<li>SQLite is now using version 3.46.</li>
<li>Demos for CodeIgniter, CakePHP, Laravel &amp; Laminas.</li>
<li>Drupal &amp; all other demos now use standard build + zip
install.</li>
<li>Modules are now webpack-compatible out of the box.</li>
<li>Exposing FS methods w/queueing &amp; locking to sync files between
tabs &amp; workers.</li>
<li>Fixed the bug with POST requests under Firefox.</li>
<li>Adding support for PHP 8.3.7</li>
<li>Automatic CI testing for PHP 8.0, 8.1, 8.2 &amp; 8.3.</li>
</ul>
<p><a
href="https://raw.githubusercontent.com/seanmorris/php-wasm/master/CHANGELOG.md">changelog</a></p>
<p>Installing php-wasm:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> npm i php-wasm@alpha</span></code></pre></div>
<p>Installing php-cgi-wasm:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> npm i php-cgi-wasm@alpha</span></code></pre></div>
<p>Installing php-wasm-builder:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> npm i php-wasm-builder@alpha</span></code></pre></div>
<h2 id="examples">☀️ Examples</h2>
<h3 id="react-php-webphp-cgi-worker-demo">[<a
href="https://seanmorris.github.io/php-wasm/">React +
php-web/php-cgi-worker demo</a>]</h3>
<table>
<tr>
<td width="500px">
<a href = "https://seanmorris.github.io/php-wasm/install-demo.html?framework=drupal-7">Drupal
Demo</a>
</td>
<td width="500px">
<a href = "https://seanmorris.github.io/php-wasm/install-demo.html?framework=cakephp-5">CakePHP
Demo</a>
</td>
<td width="500px">
<a href = "https://seanmorris.github.io/php-wasm/install-demo.html?framework=codeigniter-4">CodeIgniter
Demo</a>
</td>
<td width="500px">
<a href = "https://seanmorris.github.io/php-wasm/install-demo.html?framework=laravel-11">Laravel
Demo</a>
</td>
<td width="500px">
<a href = "https://seanmorris.github.io/php-wasm/install-demo.html?framework=laminas-3">Laminas
Demo</a>
</td>
<td width="500px">
<a href = "https://seanmorris.github.io/php-wasm/code-editor.html?path=/persist">Code
Editor</a>
</td>
</tr>
</table>
<table>
<tr>
<td width="500px" border="0">
<ul>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250Aecho%2520%2522Hello%252C%2520World%21%2522%253B%250A&autorun=1&persist=0&single-expression=0&render-as=text">Hello
World!</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522html%2522%257D%250Aphpinfo%28%29%253B%250A&autorun=1&persist=0&single-expression=0&render-as=html">phpinfo();</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm?render-as=text&autorun=1&persist=1&single-expression=0&code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Atrue%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%2524setup%2520%253D%2520%2524setup%2520%253F%253F%2520false%253B%250A%2524x%2520%253D%2520%2524x%2520%253F%253F%25200%253B%250A%250Avar_dump%28%2524x%29%253B%250A%250Aif%28%21%2524setup%29%250A%257B%250A%2520%2520%2520%2520%2524window%2520%253D%2520new%2520Vrzno%253B%250A%250A%2520%2520%2520%2520%2524f%2520%253D%2520%2524window-%253EphpFuncA%2520%253D%2520function%28%29%2520use%28%2526%2524x%252C%2520%2524window%29%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2524window-%253Ealert%28%27RAN%2520A%21%2520%27%2520.%2520%2524x%252B%252B%29%253B%250A%2520%2520%2520%2520%257D%253B%250A%2520%2520%2520%2520%250A%2520%2520%2520%2520%2524g%2520%253D%2520%2524window-%253EphpFuncB%2520%253D%2520function%28%29%2520use%28%2526%2524x%252C%2520%2524window%29%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520echo%2520%27%2524x%2520is%2520now%2520%27%2520.%2520%28%252B%252B%2524x%29%2520.%2520PHP_EOL%253B%250A%2520%2520%2520%2520%257D%253B%250A%2520%2520%2520%2520%250A%2520%2520%2520%2520%2524setup%2520%253D%2520true%253B%250A%2520%2520%2520%2520%250A%2520%2520%2520%2520echo%2520%2522Initialized.%255Cn%2522%253B%250A%257D%250A%250A%2524window-%253EphpFuncA%28%29%253B%250A%252F%252F%2520%2524window-%253EphpFuncB%28%29%253B%250A%250A%252F%252F%2520vrzno_eval%28%27window.phpFuncA%28%29%27%29%253B%250Avrzno_eval%28%27window.phpFuncB%28%29%27%29%253B%250A">Javascript
Callbacks</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Atrue%252C%2520%2522single-expression%2522%253A%2520true%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%252F%252F%2520run%2520this%2520over%2520and%2520over%2520again%250A%2524c%2520%253D%25201%2520%252B%2520%28%2524c%2520%253F%253F%2520-1%29%253B%250A%250Aprint%2520%2524c%253B%250A&autorun=1&persist=1&single-expression=1&render-as=text">Persistent
Memory</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%2524oldTitle%2520%253D%2520NULL%253B%250A%2524newTitle%2520%253D%2520%27Changed%2540%27%2520.%2520date%28%27h%253Ai%253As%27%29%253B%250A%250A%252F%252F%2520Grab%2520the%2520current%2520title%250A%2524oldTitle%2520%253D%2520vrzno_eval%28%27document.title%27%29%253B%250A%250A%252F%252F%2520Change%2520the%2520document%2520title%250A%2524newTitle%2520%253D%2520vrzno_eval%28%27document.title%2520%253D%2520%2522%27%2520.%2520%2524newTitle%2520.%2520%27%2522%27%2520%29%253B%250A%250Aprintf%28%250A%2509%27Title%2520changed%2520from%2520%2522%2525s%2522%2520to%2520%2522%2525s%2522.%27%250A%2509%252C%2520%2524oldTitle%250A%2509%252C%2520%2524newTitle%250A%29%253B%250A%250A%250A%252F%252F%2520Show%2520an%2520alert%250Avrzno_run%28%27alert%27%252C%2520%255B%27Hello%252C%2520World%21%27%255D%29%253B%250A&autorun=1&persist=0&single-expression=0&render-as=text">DOM
Access</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%2524x%2520%253D%2520false%253B%250A%250Aa%253A%250A%250Aif%28%21%2524x%29%250A%257B%250A%2509goto%2520b%253B%250A%257D%250A%250Aecho%2520%272.%2520Foo%27%2520.%2520PHP_EOL%253B%250A%250Agoto%2520c%253B%250A%250Ab%253A%250A%250Aecho%2520%271.%2520Bar%27%2520.%2520PHP_EOL%253B%250A%250Aif%28%21%2524x%29%250A%257B%250A%2509%2524x%2520%253D%2520true%253B%250A%2509goto%2520a%253B%250A%257D%250A%250Ac%253A%250Aecho%2520%273.%2520Baz%27%2520.%2520PHP_EOL%253B%250A&autorun=1&persist=0&single-expression=0&render-as=text">goto</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520true%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%252F%252F%2520Only%2520%2522single%2522%2520expressions%2520can%2520return%2520strings%2520directly%250A%252F%252F%2520So%2520wrap%2520the%2520commands%2520in%2520an%2520IFFE.%250A%250A%28function%28%29%2520%257B%250A%2509global%2520%2524persist%253B%250A%250A%2509fwrite%28fopen%28%27php%253A%252F%252Fstdout%27%252C%2520%27w%27%29%252C%2520%2522standard%2520output%21%255Cn%2522%29%253B%250A%2509fwrite%28fopen%28%27php%253A%252F%252Fstdout%27%252C%2520%27w%27%29%252C%2520sprintf%28%250A%2509%2509%2522Ran%2520%2525d%2520times%21%255Cn%2522%252C%2520%252B%252B%2524persist%250A%2509%29%29%253B%250A%2509fwrite%28fopen%28%27php%253A%252F%252Fstderr%27%252C%2520%27w%27%29%252C%2520%27standard%2520error%21%27%29%253B%250A%250A%2509return%2520%27return%2520value%27%253B%250A%257D%29%28%29%253B%250A&autorun=1&persist=1&single-expression=1&render-as=text">StdOut,
StdErr &amp; Return</a>
</li>
</ul>
</td>
<td width="500px">
<ul>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%2524db%2520%253D%2520new%2520SQLite3%28%27people.db%27%29%253B%250A%2524db-%253Equery%28%27CREATE%2520TABLE%2520IF%2520NOT%2520EXISTS%2520people%2520%28%250A%2509id%2520INTEGER%2520PRIMARY%2520KEY%252C%250A%2520%2520%2520%2509name%2520TEXT%2520NOT%2520NULL%250A%29%253B%27%29%253B%250A%250Afor%28%2524i%2520%253D%25200%253B%2520%2524i%2520%253C%2520100%253B%2520%2524i%252B%252B%29%2520%257B%250A%250A%2509%2524weirdName%2520%253D%2520str_repeat%28chr%28%2524i%252B64%29%252C%252010%29%253B%250A%2509%2524insert%2520%2520%2520%2520%253D%2520%2524db-%253Eprepare%28%27INSERT%2520INTO%2520people%2520%28name%29%2520VALUES%28%253Aname%29%27%29%253B%250A%250A%2509%2524insert-%253EbindValue%28%27%253Aname%27%252C%2520%2524weirdName%252C%2520SQLITE3_TEXT%29%253B%250A%250A%2509%2524insert-%253Eexecute%28%29%253B%250A%257D%250A%250A%2524results%2520%253D%2520%2524db-%253Equery%28%27SELECT%2520*%2520FROM%2520people%27%29%253B%250A%250A%2524rows%2520%253D%2520%255B%255D%253B%250A%250Awhile%2520%28%2524row%2520%253D%2520%2524results-%253EfetchArray%28%29%29%2520%257B%250A%2520%2520%2520%2520var_dump%28%2524row%29%253B%250A%257D%250A&autorun=1&persist=0&single-expression=0&render-as=text">Sqlite</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%2524db%2520%253D%2520new%2520PDO%28%27sqlite%253Apeople.db%27%29%253B%250A%250A%2524db-%253Equery%28%27CREATE%2520TABLE%2520IF%2520NOT%2520EXISTS%2520people%2520%28%250A%2509id%2520INTEGER%2520PRIMARY%2520KEY%252C%250A%2520%2520%2520%2509name%2520TEXT%2520NOT%2520NULL%250A%29%253B%27%29%253B%250A%250Afor%28%2524i%2520%253D%25200%253B%2520%2524i%2520%253C%252010%253B%2520%2524i%252B%252B%29%2520%257B%250A%2509%2524weirdName%2520%253D%2520str_repeat%28chr%28%2524i%252B64%29%252C%252010%29%253B%250A%2509%2524insert%2520%2520%2520%2520%253D%2520%2524db-%253Eprepare%28%27INSERT%2520INTO%2520people%2520%28name%29%2520VALUES%28%253Aname%29%27%29%253B%250A%250A%2509%2524insert-%253EbindParam%28%27%253Aname%27%252C%2520%2524weirdName%252C%2520SQLITE3_TEXT%29%253B%250A%250A%2509%2524insert-%253Eexecute%28%29%253B%250A%257D%250A%250A%2524results%2520%253D%2520%2524db-%253Equery%28%27SELECT%2520*%2520FROM%2520people%27%29%253B%250A%250A%2524rows%2520%253D%2520%255B%255D%253B%250A%250Awhile%2520%28%2524row%2520%253D%2520%2524results-%253EfetchObject%28%29%29%2520%257B%250A%2520%2520%2520%2520print_r%28%2524row%29%253B%250A%257D%250A&autorun=1&persist=0&single-expression=0&render-as=text">Sqlite
w/PDO</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%2524x%2520%253D%2520%255B%250A%2509%2522id%2522%2520%253D%253E%25201%250A%255D%253B%250A%250Avar_dump%28json_decode%28json_encode%28%2524x%29%29%29%253B%250A&autorun=1&persist=0&single-expression=0&render-as=text">JSON</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%2524x%2520%253D%252010%253B%250A%250Afunction%2520run%28callable%2520%2524f%29%2520%257B%250A%2509%2524f%28%29%253B%250A%257D%250A%250Arun%28function%2520%28%29%2520use%2520%28%2526%2524x%29%2520%257B%250A%2509%2524x%2520%253D%25209%253B%250A%257D%29%253B%250A%250Avar_dump%28%2524x%29%253B%250A&autorun=1&persist=0&single-expression=0&render-as=text">Closures</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522html%2522%257D%250A%250A%2524it%2520%253D%2520new%2520RecursiveIteratorIterator%28new%2520RecursiveDirectoryIterator%28%2522.%2522%29%29%253B%250A%250Aforeach%2520%28%2524it%2520as%2520%2524name%2520%253D%253E%2520%2524entry%29%2520%257B%250A%2509echo%2520%2524name%2520.%2520%2522%253Cbr%252F%253E%2522%253B%250A%257D%250A&autorun=1&persist=0&single-expression=0&render-as=html">File
access</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250Ainclude%28%2522%252Fpreload%252Fbench.php%2522%29%253B%250A&autorun=1&persist=0&single-expression=0&render-as=text">Zend/bench.php</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?demo=drupal.php&render-as=html&autorun=1&persist=0&single-expression=0&code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Afalse%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522html%2522%257D%250Aini_set%28%27session.save_path%27%252C%2520%27%252Fpersist%27%29%253B%250A%250A%2524stdErr%2520%253D%2520fopen%28%27php%253A%252F%252Fstderr%27%252C%2520%27w%27%29%253B%250A%2524errors%2520%253D%2520%255B%255D%253B%250A%250Aset_error_handler%28function%28...%2524args%29%2520use%28%2524stdErr%252C%2520%2526%2524errors%29%257B%250A%2509fwrite%28%2524stdErr%252C%2520print_r%28%2524args%252C1%29%29%253B%250A%257D%29%253B%250A%250A%2524docroot%2520%253D%2520%27%252Fpersist%252Fdrupal-7.95%27%253B%250A%2524path%2520%2520%2520%2520%253D%2520%27%252Fnode%27%253B%250A%2524script%2520%2520%253D%2520%27index.php%27%253B%250A%250Aif%28%21is_dir%28%2524docroot%29%29%250A%257B%250A%2520%2520%2520%2520%2524it%2520%253D%2520new%2520RecursiveIteratorIterator%28new%2520RecursiveDirectoryIterator%28%2522%252Fpreload%252Fdrupal-7.95%252F%2522%252C%2520FilesystemIterator%253A%253ASKIP_DOTS%29%29%253B%250A%2520%2520%2520%2520foreach%2520%28%2524it%2520as%2520%2524name%2520%253D%253E%2520%2524entry%29%250A%2520%2520%2520%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520if%28is_dir%28%2524name%29%29%2520continue%253B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2524fromDir%2520%253D%2520dirname%28%2524name%29%253B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2524toDir%2520%2520%253D%2520%27%252Fpersist%27%2520.%2520substr%28%2524fromDir%252C%25208%29%253B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2524filename%2520%253D%2520basename%28%2524name%29%253B%250A%2520%2520%2520%2520%2509%2524pDirs%2520%253D%2520%255B%2524pDir%2520%253D%2520%2524toDir%255D%253B%250A%2520%2520%2520%2520%2509while%28%2524pDir%2520%21%253D%253D%2520dirname%28%2524pDir%29%29%2520%2524pDirs%255B%255D%2520%253D%2520%2524pDir%2520%253D%2520dirname%28%2524pDir%29%253B%250A%2520%2520%2520%2520%2509%2524pDirs%2520%253D%2520array_reverse%28%2524pDirs%29%253B%250A%2520%2520%2520%2520%2509foreach%28%2524pDirs%2520as%2520%2524pDir%29%2520if%28%21is_dir%28%2524pDir%29%29%2520mkdir%28%2524pDir%252C%25200777%29%253B%250A%2520%2520%2520%2520%2509file_put_contents%28%2524toDir%2520%2520.%2520%27%252F%27%2520.%2520%2524filename%252C%2520file_get_contents%28%2524fromDir%2520.%2520%27%252F%27%2520.%2520%2524filename%29%29%253B%250A%2520%2520%2520%2520%257D%250A%257D%250A%250A%2524_SERVER%255B%27REQUEST_URI%27%255D%2520%2520%2520%2520%2520%253D%2520%27%252Fphp-wasm%27%2520.%2520%2524docroot%2520.%2520%2524path%253B%250A%2524_SERVER%255B%27REMOTE_ADDR%27%255D%2520%2520%2520%2520%2520%253D%2520%27127.0.0.1%27%253B%250A%2524_SERVER%255B%27SERVER_NAME%27%255D%2520%2520%2520%2520%2520%253D%2520%27localhost%27%253B%250A%2524_SERVER%255B%27SERVER_PORT%27%255D%2520%2520%2520%2520%2520%253D%25203333%253B%250A%2524_SERVER%255B%27REQUEST_METHOD%27%255D%2520%2520%253D%2520%27GET%27%253B%250A%2524_SERVER%255B%27SCRIPT_FILENAME%27%255D%2520%253D%2520%2524docroot%2520.%2520%27%252F%27%2520.%2520%2524script%253B%250A%2524_SERVER%255B%27SCRIPT_NAME%27%255D%2520%2520%2520%2520%2520%253D%2520%2524docroot%2520.%2520%27%252F%27%2520.%2520%2524script%253B%250A%2524_SERVER%255B%27PHP_SELF%27%255D%2520%2520%2520%2520%2520%2520%2520%2520%253D%2520%2524docroot%2520.%2520%27%252F%27%2520.%2520%2524script%253B%250A%250Achdir%28%2524docroot%29%253B%250A%250Aif%28%21defined%28%27DRUPAL_ROOT%27%29%29%2520define%28%27DRUPAL_ROOT%27%252C%2520getcwd%28%29%29%253B%250A%250Arequire_once%2520DRUPAL_ROOT%2520.%2520%27%252Fincludes%252Fbootstrap.inc%27%253B%250Adrupal_bootstrap%28DRUPAL_BOOTSTRAP_FULL%29%253B%250Adrupal_session_start%28%29%253B%250A%250Afwrite%28%2524stdErr%252C%2520json_encode%28%255B%27session_id%27%2520%253D%253E%2520session_id%28%29%255D%29%2520.%2520%2522%255Cn%2522%29%253B%250A%250Aglobal%2520%2524user%253B%250A%250A%2524uid%2520%2520%2520%2520%2520%253D%25201%253B%250A%2524user%2520%2520%2520%2520%253D%2520user_load%28%2524uid%29%253B%250A%2524account%2520%253D%2520array%28%27uid%27%2520%253D%253E%2520%2524user-%253Euid%29%253B%250A%2524session_name%2520%253D%2520session_name%28%29%253B%250A%250Aif%28%21%2524_COOKIE%2520%257C%257C%2520%21%2524_COOKIE%255B%2524%2524session_name%255D%29%250A%257B%250A%2509user_login_submit%28array%28%29%252C%2520%2524account%29%253B%250A%257D%250A%250A%2524itemPath%2520%253D%2520%2524path%253B%250A%2524itemPath%2520%253D%2520preg_replace%28%27%252F%255E%255C%255C%252F%252F%27%252C%2520%27%27%252C%2520%2524path%29%253B%250A%250A%2524GLOBALS%255B%27base_path%27%255D%2520%253D%2520%27%252Fphp-wasm%27%2520.%2520%2524docroot%2520.%2520%27%252F%27%253B%250A%2524base_url%2520%253D%2520%27%252Fphp-wasm%27%2520.%2520%2524docroot%253B%250A%250A%2524_GET%255B%27q%27%255D%2520%253D%2520%2524itemPath%253B%250A%250Amenu_execute_active_handler%28%29%253B%250A%250Afwrite%28%2524stdErr%252C%2520json_encode%28%255B%27HEADERS%27%2520%253D%253Eheaders_list%28%29%255D%29%2520.%2520%2522%255Cn%2522%29%253B%250Afwrite%28%2524stdErr%252C%2520json_encode%28%255B%27COOKIE%27%2520%2520%253D%253E%2520%2524_COOKIE%255D%29%2520.%2520PHP_EOL%29%253B%250Afwrite%28%2524stdErr%252C%2520json_encode%28%255B%27errors%27%2520%2520%253D%253E%2520error_get_last%28%29%255D%29%2520.%2520%2522%255Cn%2522%29%253B%250A">Drupal
7</a>
</li>
</ul>
</td>
<td width="500px">
<ul>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Atrue%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%2524window%2520%253D%2520new%2520Vrzno%253B%250A%2524import%2520%253D%2520vrzno_import%28%27https%253A%252F%252Fcdn.jsdelivr.net%252Fnpm%252F%2540observablehq%252Fplot%25400.6%252F%252Besm%27%29%253B%250A%250A%2524import-%253Ethen%28function%28%2524Plot%29%2520use%28%2524window%29%2520%257B%250A%250A%2509%2524plot%2520%253D%2520%2524Plot-%253ErectY%28%250A%250A%2509%2509%28object%29%255B%27length%27%2520%253D%253E%2520100000%255D%252C%250A%250A%2509%2509%2524Plot-%253EbinX%28%250A%2509%2509%2509%28object%29%255B%27y%27%253D%253E%2520function%28%2524a%252C%2524b%29%257B%2520return%2520-cos%28%2524b-%253Ex1*pi%28%29%29%253B%2520%257D%255D%252C%250A%2509%2509%2509%28object%29%255B%27x%27%253D%253E%2520%2524window-%253EMath-%253Erandom%255D%250A%2509%2509%29%250A%250A%2509%29-%253Eplot%28%29%253B%250A%250A%2509%2524renderTo%2520%253D%2520%2524window-%253Edocument-%253Ebody-%253EquerySelector%28%27%2523example%27%29%253B%250A%2509%2524renderTo-%253EinnerHTML%2520%253D%2520%27%27%253B%250A%250A%2509%2524renderTo-%253Eappend%28%2524plot%29%253B%250A%250A%257D%29-%253Ecatch%28fn%28%2524error%29%2520%253D%253E%2520%2524window-%253Econsole-%253Eerror%28%2524error-%253Emessage%29%29%253B%250A&autorun=1&persist=1&single-expression=0&render-as=text&demo=import.php">Import
Javascript Libs</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Atrue%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%250A%2524url%2520%253D%2520%27https%253A%252F%252Fapi.weather.gov%252Fgridpoints%252FTOP%252F40%252C74%252Fforecast%27%253B%250A%250A%2524window%2520%253D%2520new%2520Vrzno%253B%250A%2524window-%253Efetch%28%2524url%29%250A-%253Ethen%28function%28%2524r%29%2520%257B%2520return%2520%2524r-%253Ejson%28%29%253B%2520%257D%29%250A-%253Ethen%28var_dump%28...%29%29%253B%250A%250Aecho%2520%2522Yeah%252C%2520its%2520async.%255Cn%255Cn%2522%253B%250A&autorun=1&persist=1&single-expression=0&render-as=text&demo=fetch.php">Fetch</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Atrue%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%2524window%2520%253D%2520%2524window%2520%253F%253F%2520new%2520Vrzno%253B%250A%250A%2524Promise%2520%253D%2520%2524window-%253EPromise%253B%250A%250A%2524promise%2520%253D%2520vrzno_new%28%2524Promise%252C%2520function%28%2524accept%252C%2520%2524reject%29%2520%257B%250A%250A%2520%2520%2520%2520%2524window%2520%253D%2520new%2520Vrzno%253B%250A%250A%2520%2520%2520%2520if%281%29%250A%2520%2520%2520%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2524accept%28%27Something.%27%29%253B%250A%2520%2520%2520%2520%2520%2520%2520%2520%252F%252F%2520%2524window-%253EsetTimeout%28%250A%2520%2520%2520%2520%2520%2520%2520%2520%252F%252F%2520%2520%2520%2520%2520fn%28%29%2520%253D%253E%2520%2524accept%28%27Something.%27%29%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520%252F%252F%2520%2520%2520%2520%25201000%250A%2520%2520%2520%2520%2520%2520%2520%2520%252F%252F%2520%29%253B%250A%2520%2520%2520%2520%257D%250A%2520%2520%2520%2520else%250A%2520%2520%2520%2520%257B%250A%2520%2520%2520%2520%2520%2520%2520%2520%2524window-%253EsetTimeout%28%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520fn%28%29%2520%253D%253E%2520%2524reject%28%27Error.%27%29%252C%250A%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%2520%25201000%250A%2520%2520%2520%2520%2520%2520%2520%2520%29%253B%250A%2520%2520%2520%2520%257D%250A%250A%257D%29%253B%250A%250A%2524promise-%253Ethen%28var_dump%28...%29%29-%253Ecatch%28var_dump%28...%29%29%253B%250A&autorun=1&persist=1&single-expression=0&render-as=text&demo=promise.php">Promise</a>
</li>
<li>
<a href = "https://seanmorris.github.io/php-wasm/?code=%253C%253Fphp%2520%252F%252F%2520%257B%2522autorun%2522%253Atrue%252C%2520%2522persist%2522%253Atrue%252C%2520%2522single-expression%2522%253A%2520false%252C%2520%2522render-as%2522%253A%2520%2522text%2522%257D%250A%2524window%2520%253D%2520new%2520Vrzno%253B%250A%2524require%2520%253D%2520%2524window-%253Erequire%253B%250A%2524Form%2520%253D%2520%2524require%28%27curvature%252Fform%252FForm%27%29-%253EForm%253B%250A%2524View%2520%253D%2520%2524require%28%27curvature%252Fbase%252FView%27%29-%253EView%253B%250A%250A%2524form%2520%253D%2520new%2520%2524Form%28%28object%29%255B%250A%2520%2520%2520%2520%27id%27%2520%2520%2520%253D%253E%2520%28object%29%255B%27type%27%2520%253D%253E%2520%27number%27%255D%252C%250A%2520%2520%2520%2520%27name%27%2520%253D%253E%2520%28object%29%255B%27type%27%2520%253D%253E%2520%27text%27%255D%252C%250A%255D%29%253B%250A%250A%2524view%2520%253D%2520%2524View-%253Efrom%28%27%253Cdiv%2520style%2520%253D%2520%2522display%253Aflex%253Bflex-direction%253Arow%253Bmargin%253A1rem%253B%2522%253E%250A%2509%253Cdiv%2520style%2520%253D%2520%2522margin-right%253A1rem%2522%253E%250A%2509%2509%253Cp%253ECounter%253C%252Fp%253E%250A%2509%2509%253Cdiv%2520style%2520%253D%2520%2522display%253Aflex%253Bflex-direction%253Arow%253Bmargin%253A1rem%2520auto%253Bmin-width%253A4rem%253B%2522%253E%250A%2509%2509%2509%253Cbutton%2520cv-on%2520%253D%2520%2522click%253Adec%2522%2520style%2520%253D%2520%2522flex%253A1%2522%253E-%253C%252Fbutton%253E%250A%2509%2509%2509%253Cbutton%2520cv-on%2520%253D%2520%2522click%253Ainc%2522%2520style%2520%253D%2520%2522flex%253A1%2522%253E%252B%253C%252Fbutton%253E%250A%2509%2509%253C%252Fdiv%253E%250A%2509%2509%253Cdiv%2520style%2520%253D%2520%2522font-size%253A6rem%253B%2522%253E%255B%255Bcounter%255D%255D%253C%252Fdiv%253E%250A%2509%253C%252Fdiv%253E%250A%2509%253Cdiv%2520style%2520%253D%2520%2522margin-right%253A1rem%2522%253E%250A%2509%2509%253Cp%253EForm%253A%2520%255B%255Bform%255D%255D%253C%252Fp%253E%250A%2509%2509%253Cp%253ESerialized%253A%2520%255B%255Bserialized%255D%255D%253C%252Fp%253E%250A%2509%2509%253Cp%253EJSON%253A%2520%255B%255Bjson%255D%255D%253C%252Fp%253E%250A%2509%253C%252Fdiv%253E%250A%253C%252Fdiv%253E%27%29%253B%250A%250A%2524form-%253EbindTo%28%27json%27%252C%2520function%28%2524json%2520%253D%2520NULL%29%2520use%28%2524view%252C%2520%2524form%29%2520%257B%250A%2520%2520%2520%2520%2524view-%253Eargs-%253Eserialized%2520%253D%2520serialize%28%2524form-%253Eargs-%253Evalue%29%253B%250A%2520%2520%2520%2520%2524view-%253Eargs-%253Ejson%2520%253D%2520%2524json%253B%250A%257D%29%253B%250A%250A%2524view-%253Eargs-%253Ecounter%2520%253D%25200%253B%250A%2524view-%253Eargs-%253Eform%2520%253D%2520%2524form%253B%250A%250A%2524view-%253Einc%2520%253D%2520fn%28%29%2520%253D%253E%2520%2524view-%253Eargs-%253Ecounter%252B%252B%253B%250A%2524view-%253Edec%2520%253D%2520fn%28%29%2520%253D%253E%2520%2524view-%253Eargs-%253Ecounter--%253B%250A%250A%2524renderTo%2520%253D%2520%2524window-%253Edocument-%253Ebody-%253EquerySelector%28%27%2523example%27%29%253B%250A%2524renderTo-%253EinnerHTML%2520%253D%2520%27%27%253B%250A%2524view-%253Erender%28%2524renderTo%29%253B%250A&autorun=1&persist=1&single-expression=0&render-as=text&demo=curvature.php">Curvature</a>
</li>
<li>
<a href = "https://github.com/seanmorris/php-gtk">php-gtk</a>
</li>
<li>
<a href = "https://php-cloud.pages.dev/">php in cloudflare workers</a>
</li>
<br />
</ul>
</td>
</tr>
</table>
<h2 id="introducing-php-cgi-wasm">🎩 Introducing php-cgi-wasm!</h2>
<p>Version 0.0.9 adds <code>php-cgi-wasm</code> to the mix. This allows
you to run php in web-server mode, similar to how it runs under apache
or nginx. Running within a Service Worker, it can intercept and respond
to HTTP requests just like a normal webserver. This means the browser
can simply navigate to a URL, and PHP will generate the page, and
everything will work as-normal, AJAX and all. From the perspective of
the webpage, its just making HTTP requests. Its not worried about
whether the PHP runs on the server or in a Service Worker.</p>
<h3 id="install-the-php-cgi-wasm-package">Install the php-cgi-wasm
package</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> npm install php-cgi-wasm</span></code></pre></div>
<h3 id="example-service-worker">Example Service Worker:</h3>
<div class="sourceCode" id="cb5"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { PhpCgiWorker } <span class="im">from</span> <span class="st">&quot;php-cgi-wasm/PhpCgiWorker&quot;</span><span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Spawn the PHP-CGI binary</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpCgiWorker</span>({</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">prefix</span><span class="op">:</span>  <span class="st">&#39;/php-wasm&#39;</span><span class="op">,</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">docroot</span><span class="op">:</span> <span class="st">&#39;/persist/www&#39;</span><span class="op">,</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">types</span><span class="op">:</span> {</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">jpg</span><span class="op">:</span>  <span class="st">&#39;image/jpeg&#39;</span><span class="op">,</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">jpeg</span><span class="op">:</span> <span class="st">&#39;image/jpeg&#39;</span><span class="op">,</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">gif</span><span class="op">:</span>  <span class="st">&#39;image/gif&#39;</span><span class="op">,</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">png</span><span class="op">:</span>  <span class="st">&#39;image/png&#39;</span><span class="op">,</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">svg</span><span class="op">:</span>  <span class="st">&#39;image/svg+xml&#39;</span><span class="op">,</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Set up the event handlers</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>self<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;install&#39;</span><span class="op">,</span>  <span class="bu">event</span> <span class="kw">=&gt;</span> php<span class="op">.</span><span class="fu">handleInstallEvent</span>(<span class="bu">event</span>))<span class="op">;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>self<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;activate&#39;</span><span class="op">,</span> <span class="bu">event</span> <span class="kw">=&gt;</span> php<span class="op">.</span><span class="fu">handleActivateEvent</span>(<span class="bu">event</span>))<span class="op">;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>self<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;fetch&#39;</span><span class="op">,</span>    <span class="bu">event</span> <span class="kw">=&gt;</span> php<span class="op">.</span><span class="fu">handleFetchEvent</span>(<span class="bu">event</span>))<span class="op">;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>self<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;message&#39;</span><span class="op">,</span>  <span class="bu">event</span> <span class="kw">=&gt;</span> php<span class="op">.</span><span class="fu">handleMessageEvent</span>(<span class="bu">event</span>))<span class="op">;</span></span></code></pre></div>
<p>You can see examples of php-cgi-wasm running in a service worker and
nodejs in <a
href="demo-web/src/cgi-worker.mjs"><code>demo-web/src/cgi-worker.mjs</code></a>
&amp; <a href="demo-node/index.mjs"><code>demo-node/index.mjs</code></a>
respectively.</p>
<p><strong><em>Note:</em></strong> <code>php-cgi-wasm</code> &amp;
<code>php-wasm</code> are separate packages. One “embeds” php right into
your javascript, the other runs in “cgi-mode,” just like php would under
apache or nginx.</p>
<p>You can find documentation specific to php-cgi-wasm <a
href="packages/php-cgi-wasm">here</a>.</p>
<h2 id="install-use">🛠️ Install &amp; Use</h2>
<p>Install php-wasm with npm:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> npm install php-wasm</span></code></pre></div>
<p>Include the module in your preferred format:</p>
<h3 id="common-js">Common JS</h3>
<div class="sourceCode" id="cb7"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { PhpWeb } <span class="op">=</span> <span class="pp">require</span>(<span class="st">&#39;php-wasm/PhpWeb.js&#39;</span>)<span class="op">;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> PhpWeb<span class="op">;</span></span></code></pre></div>
<h3 id="esm">ESM</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { PhpWeb } <span class="im">from</span> <span class="st">&#39;php-wasm/PhpWeb.mjs&#39;</span><span class="op">;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> PhpWeb<span class="op">;</span></span></code></pre></div>
<h4 id="from-a-cdn">From a CDN:</h4>
<p><strong><em>Note: This does not require npm.</em></strong></p>
<h5 id="jsdelivr">jsdelivr</h5>
<div class="sourceCode" id="cb9"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { PhpWeb } <span class="op">=</span> <span class="cf">await</span> <span class="im">import</span>(<span class="st">&#39;https://cdn.jsdelivr.net/npm/php-wasm/PhpWeb.mjs&#39;</span>)<span class="op">;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> PhpWeb<span class="op">;</span></span></code></pre></div>
<h5 id="unpkg">unpkg</h5>
<div class="sourceCode" id="cb10"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { PhpWeb } <span class="op">=</span> <span class="cf">await</span> <span class="im">import</span>(<span class="st">&#39;https://www.unpkg.com/php-wasm/php-wasm/PhpWeb.mjs&#39;</span>)<span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> PhpWeb<span class="op">;</span></span></code></pre></div>
<h4 id="pre-packaged-static-assets">Pre-Packaged Static Assets:</h4>
<p>If you’re using a bundler, use the vendor’s documentation to learn
how to move the files matching the following pattern to your public
directory:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">node_modules/php-wasm/php-web.mjs.wasm</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">node_modules/php-wasm/php-worker.mjs.wasm</span> <span class="co"># ONLY if you&#39;re running the standard build in a worker</span></span></code></pre></div>
<p>For php-cgi-wasm:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">node_modules/php-cgi-wasm/php-cgi-worker.mjs.wasm</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">node_modules/php-cgi-wasm/php-cgi-web.mjs.wasm</span> <span class="co"># ONLY if you&#39;re running the cgi build in a page</span></span></code></pre></div>
<h2 id="quickstart">🍎 Quickstart</h2>
<h3 id="inline-php">Inline PHP</h3>
<p>Include the <code>php-tags.js</code> script from a CDN:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">async</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/javascript&quot;</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">&quot;https://cdn.jsdelivr.net/npm/php-wasm/php-tags.jsdelivr.mjs&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span></code></pre></div>
<p>And run some PHP right in the page!</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/php&quot;</span> <span class="er">data-stdout</span> <span class="ot">=</span> <span class="st">&quot;#output&quot;</span><span class="kw">&gt;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;?</span>php <span class="fu">phpinfo</span>()<span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/script&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span> <span class="ot">=</span> <span class="st">&quot;output&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span></code></pre></div>
<p>Inline php can use standard input, output and error with
<code>data-</code> attributes. Just set the value of the attribute to a
selector that will match that tag.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">async</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/javascript&quot;</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">&quot;https://cdn.jsdelivr.net/npm/php-wasm/php-tags.jsdelivr.mjs&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">id</span> <span class="ot">=</span> <span class="st">&quot;input&quot;</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/plain&quot;</span><span class="kw">&gt;</span>Hello<span class="op">,</span> world<span class="op">!</span><span class="kw">&lt;/script&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/php&quot;</span> <span class="er">data-stdin</span> <span class="ot">=</span> <span class="st">&quot;#input&quot;</span> <span class="er">data-stdout</span> <span class="ot">=</span> <span class="st">&quot;#output&quot;</span> <span class="er">data-stderr</span> <span class="ot">=</span> <span class="st">&quot;#error&quot;</span><span class="kw">&gt;</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">&lt;?</span>php echo <span class="fu">file_get_contents</span>(<span class="st">&#39;php://stdin&#39;</span>)<span class="op">;</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/script&gt;</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span> <span class="ot">=</span> <span class="st">&quot;output&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">id</span> <span class="ot">=</span> <span class="st">&quot;error&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span></code></pre></div>
<p>The <code>src</code> attribute can be used on
<code>&lt;script type = "text/php"&gt;</code> tags, as well as their
input elements. For example:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;head&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;script</span> <span class="er">async</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/javascript&quot;</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">&quot;https://cdn.jsdelivr.net/npm/php-wasm/php-tags.jsdelivr.mjs&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;script</span> <span class="er">id</span> <span class="ot">=</span> <span class="st">&quot;input&quot;</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">&quot;/test-input.json&quot;</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/json&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;script</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/php&quot;</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">&quot;/test.php&quot;</span> <span class="er">data-stdin</span> <span class="ot">=</span> <span class="st">&quot;#input&quot;</span> <span class="er">data-stdout</span> <span class="ot">=</span> <span class="st">&quot;#output&quot;</span> <span class="er">data-stderr</span> <span class="ot">=</span> <span class="st">&quot;#error&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/head&gt;</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;body&gt;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div</span> <span class="er">id</span> <span class="ot">=</span> <span class="st">&quot;output&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div</span> <span class="er">id</span> <span class="ot">=</span> <span class="st">&quot;error&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/body&gt;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<h4 id="cdns">CDNs</h4>
<h5 id="jsdelivr-1">JSDelivr</h5>
<div class="sourceCode" id="cb17"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">async</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/javascript&quot;</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">&quot;https://cdn.jsdelivr.net/npm/php-wasm/php-tags.jsdelivr.mjs&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span></code></pre></div>
<h5 id="unpkg-1">Unpkg</h5>
<div class="sourceCode" id="cb18"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">async</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/javascript&quot;</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">&quot;https://www.unpkg.com/php-wasm/php-tags.unpkg.mjs&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span></code></pre></div>
<!--
##### esm.sh
```html
<script async type = "text/javascript" src = "https://esm.sh/php-wasm/php-wasm/php-tags.jsdelivr.mjs"></script>
``` -->
<h2 id="running-php-taking-output">🥤 Running PHP &amp; Taking
Output</h2>
<p>Create a PHP instance:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { PhpWeb } <span class="op">=</span> <span class="cf">await</span> <span class="im">import</span>(<span class="st">&#39;https://cdn.jsdelivr.net/npm/php-wasm/PhpWeb.mjs&#39;</span>)<span class="op">;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> PhpWeb<span class="op">;</span></span></code></pre></div>
<p>Add your output listeners:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Listen to STDOUT</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>php<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;output&#39;</span><span class="op">,</span> (<span class="bu">event</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="bu">event</span><span class="op">.</span><span class="at">detail</span>)<span class="op">;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Listen to STDERR</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>php<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;error&#39;</span><span class="op">,</span> (<span class="bu">event</span>) <span class="kw">=&gt;</span> {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="bu">event</span><span class="op">.</span><span class="at">detail</span>)<span class="op">;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<p>Provide some input data on STDIN if you need to:</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>php<span class="op">.</span><span class="fu">inputString</span>(<span class="st">&#39;This is a string of data provided on STDIN.&#39;</span>)<span class="op">;</span></span></code></pre></div>
<p>… then run some PHP!</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> exitCode <span class="op">=</span> <span class="cf">await</span> php<span class="op">.</span><span class="fu">run</span>(<span class="st">&#39;&lt;?php echo &quot;Hello, world!&quot;;&#39;</span>)<span class="op">;</span></span></code></pre></div>
<h3 id="dynamic-extensions-in-static-pages">Dynamic Extensions in Static
Pages</h3>
<p>Dynamic extensions can be loaded in static webpages like so:</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode html"><code class="sourceCode html"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span> <span class="er">async</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;module&quot;</span> <span class="er">src</span> <span class="ot">=</span> <span class="st">&quot;https://cdn.jsdelivr.net/npm/php-wasm@0.0.9-alpha-12/php-tags.mjs&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;script</span><span class="ot"> type</span> <span class="ot">=</span> <span class="st">&quot;text/php&quot;</span> <span class="er">data-stdout</span> <span class="ot">=</span> <span class="st">&quot;#output&quot;</span> <span class="er">data-stderr</span> <span class="ot">=</span> <span class="st">&quot;#error&quot;</span> <span class="er">data-libs</span> <span class="ot">=</span> <span class="st">&#39;[</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="st">  {&quot;url&quot;: &quot;https://unpkg.com/php-wasm-yaml/php8.3-yaml.so&quot;, &quot;ini&quot;: true},</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="st">  {&quot;url&quot;: &quot;https://unpkg.com/php-wasm-yaml/libyaml.so&quot;, &quot;ini&quot;: false}</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="st">]&#39;</span><span class="kw">&gt;</span><span class="op">&lt;?</span>php</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  print <span class="fu">yaml_emit</span>([<span class="dv">1</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="st">&quot;string&quot;</span><span class="op">,</span>[<span class="st">&quot;k1&quot;</span> <span class="kw">=&gt;</span> <span class="st">&quot;value&quot;</span><span class="op">,</span> <span class="st">&quot;k2&quot;</span> <span class="kw">=&gt;</span> <span class="st">&quot;value2&quot;</span><span class="op">,</span> <span class="st">&quot;k3&quot;</span> <span class="kw">=&gt;</span> <span class="st">&quot;value3&quot;</span>]<span class="op">,</span><span class="st">&quot;now&quot;</span> <span class="kw">=&gt;</span> <span class="fu">date</span>(<span class="st">&quot;Y-m-d h:i:s&quot;</span>)])<span class="op">;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/script&gt;</span></span></code></pre></div>
<h2 id="configuration">⚙️ Configuration</h2>
<p>You can pass in the <code>ini</code> property to the constructor to
add lines to <code>/php.ini</code>:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">ini</span><span class="op">:</span> <span class="vs">`</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="vs">    date.timezone=</span><span class="sc">${</span><span class="bu">Intl</span><span class="op">.</span><span class="fu">DateTimeFormat</span>()<span class="op">.</span><span class="fu">resolvedOptions</span>()<span class="op">.</span><span class="at">timeZone</span><span class="sc">}</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="vs">    tidy.clean_output=1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="vs">    expose_php=0</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span>})<span class="op">;</span></span></code></pre></div>
<p>The <code>/config/php.ini</code> and <code>/preload/php.ini</code>
files will also be loaded, if they exist. Neither of these files will be
created if they do not exist. They’re left completely up to the
programmer to create &amp; populate.</p>
<p>Options like the following may appear in these files. See the <a
href="https://www.php.net/manual/en/ini.list.php">PHP docs</a> for the
full list.</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[php]</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="dt">date.timezone</span><span class="ot">=</span><span class="st">UTC</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="dt">tidy.clean_output</span><span class="ot">=</span><span class="dv">1</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="dt">expose_php</span><span class="ot">=</span><span class="dv">0</span></span></code></pre></div>
<h3 id="cgi-configuration">CGI Configuration</h3>
<p>When running in CGI mode, php will look for a <code>php.ini</code>
file in the document root directory, and load it along with the files
listed above.</p>
<h3 id="writing-an-ini-for-multiple-php-versions">Writing an INI for
multiple PHP versions</h3>
<p>PHP will replace strings in INI files in the form
<code>${ENVIRONMENT_VARIABLE}</code> with the env value of
<code>ENVIRONMENT_VARIABLE</code>. The <code>PHP_VERSION</code>
environment variable is available to allow loading of the extension
compatible with the currently running version of PHP:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode ini"><code class="sourceCode ini"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[php]</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="dt">extension</span><span class="ot">=</span><span class="st">php${PHP_VERSION}-phar.so</span></span></code></pre></div>
<p>Remember to correctly escape the <code>$</code> if you’re supplying
the INI from Javascript with `<code>backtics</code>`:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">ini</span><span class="op">:</span> <span class="vs">`</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="vs">    extension=php</span><span class="sc">\$</span><span class="vs">{PHP_VERSION}-phar.so</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="vs">    date.timezone=</span><span class="sc">${</span><span class="bu">Intl</span><span class="op">.</span><span class="fu">DateTimeFormat</span>()<span class="op">.</span><span class="fu">resolvedOptions</span>()<span class="op">.</span><span class="at">timeZone</span><span class="sc">}</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="vs">`</span>})<span class="op">;</span></span></code></pre></div>
<h2 id="extensions">🔌 Extensions</h2>
<h3 id="loading-extensions-at-runtime">Loading extensions at
runtime</h3>
<p>The following extensions may be loaded at runtime. This allows the
shared extension &amp; their dependencies to be cached, re-used, and
selected a-la-carte for each application.</p>
<ul>
<li>gd (<a href="https://www.npmjs.com/package/php-wasm-gd"
class="uri">https://www.npmjs.com/package/php-wasm-gd</a>)</li>
<li>iconv (<a href="https://www.npmjs.com/package/php-wasm-iconv"
class="uri">https://www.npmjs.com/package/php-wasm-iconv</a>)</li>
<li>intl (<a href="https://www.npmjs.com/package/php-wasm-intl"
class="uri">https://www.npmjs.com/package/php-wasm-intl</a>)</li>
<li>xml (<a href="https://www.npmjs.com/package/php-wasm-libxml"
class="uri">https://www.npmjs.com/package/php-wasm-libxml</a>)</li>
<li>dom (<a href="https://www.npmjs.com/package/php-wasm-libxml"
class="uri">https://www.npmjs.com/package/php-wasm-libxml</a>)</li>
<li>simplexml (<a href="https://www.npmjs.com/package/php-wasm-libxml"
class="uri">https://www.npmjs.com/package/php-wasm-libxml</a>)</li>
<li>yaml (<a href="https://www.npmjs.com/package/php-wasm-libyaml"
class="uri">https://www.npmjs.com/package/php-wasm-libyaml</a>)</li>
<li>zip (<a href="https://www.npmjs.com/package/php-wasm-libzip"
class="uri">https://www.npmjs.com/package/php-wasm-libzip</a>)</li>
<li>mbstring (<a href="https://www.npmjs.com/package/php-wasm-mbstring"
class="uri">https://www.npmjs.com/package/php-wasm-mbstring</a>)</li>
<li>openssl (<a href="https://www.npmjs.com/package/php-wasm-openssl"
class="uri">https://www.npmjs.com/package/php-wasm-openssl</a>)</li>
<li>phar (<a href="https://www.npmjs.com/package/php-wasm-phar"
class="uri">https://www.npmjs.com/package/php-wasm-phar</a>)</li>
<li>sqlite (<a href="https://www.npmjs.com/package/php-wasm-sqlite"
class="uri">https://www.npmjs.com/package/php-wasm-sqlite</a>)</li>
<li>pdo-sqlite (<a href="https://www.npmjs.com/package/php-wasm-sqlite"
class="uri">https://www.npmjs.com/package/php-wasm-sqlite</a>)</li>
<li>zlib (<a href="https://www.npmjs.com/package/php-wasm-zlib"
class="uri">https://www.npmjs.com/package/php-wasm-zlib</a>)</li>
</ul>
<p>There are two ways to load extensions at runtime, using the
<code>dl()</code> function or <code>php.ini</code>.</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode php"><code class="sourceCode php"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;?php</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dl</span>(<span class="st">&#39;php-8.3-xml.so&#39;</span>)<span class="ot">;</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dl</span>(<span class="st">&#39;php-8.3-dom.so&#39;</span>)<span class="ot">;</span></span></code></pre></div>
<p>or, pass an array as the <code>extensions</code> argument to the
constructor from Javascript to auto-generate an ini file that loads your
extensions:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">sharedLibs</span><span class="op">:</span> [</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`php8.3-xml.so`</span><span class="op">,</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`php8.3-dom.so`</span><span class="op">,</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>]})<span class="op">;</span></span></code></pre></div>
<p>The class used to load PHP (<code>PhpWeb</code> here) also implements
a phpVersion property to ensure libs can be loaded for any compatible
version:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">sharedLibs</span><span class="op">:</span> [</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`php</span><span class="sc">${</span>PhpWeb<span class="op">.</span><span class="at">phpVersion</span><span class="sc">}</span><span class="vs">-xml.so`</span><span class="op">,</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`php</span><span class="sc">${</span>PhpWeb<span class="op">.</span><span class="at">phpVersion</span><span class="sc">}</span><span class="vs">-dom.so`</span><span class="op">,</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>]})<span class="op">;</span></span></code></pre></div>
<h3 id="dynamic-extensions-from-remote-servers">Dynamic Extensions from
Remote Servers:</h3>
<p>You can also load extensions from remote servers with URLs:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">sharedLibs</span><span class="op">:</span> [<span class="vs">`https://unpkg.com/php-wasm-phar/php8.3-phar.so`</span>]})<span class="op">;</span></span></code></pre></div>
<p>The above is actually shorthand for the following code. Passing
<code>ini: true</code> will automatically load the extension via
<code>/php.ini</code>, passing <code>ini: false</code> will wait for a
call to <code>dl()</code> to do the lookup.</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">sharedLibs</span><span class="op">:</span> [</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        <span class="dt">name</span><span class="op">:</span> <span class="vs">`php8.3-phar.so`</span><span class="op">,</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">url</span><span class="op">:</span>  <span class="vs">`https://unpkg.com/php-wasm-phar/php8.3-phar.so`</span><span class="op">,</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">ini</span><span class="op">:</span>  <span class="kw">true</span><span class="op">,</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>]})<span class="op">;</span></span></code></pre></div>
<p>Strings starting with <code>/</code>, <code>./</code>,
<code>http://</code> or <code>https://</code> will be treated as
URLs:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">sharedLibs</span><span class="op">:</span> [</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="vs">`./php8.3-phar.so`</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>]})<span class="op">;</span></span></code></pre></div>
<p>Some extensions require supporting libraries. You can provide URLs
for those as <code>sharedLibs</code> as well, just pass
<code>ini: false</code>:</p>
<p><em>(<code>name</code> is implied to be the last section of the URL
here.)</em></p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">sharedLibs</span><span class="op">:</span> [</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">url</span><span class="op">:</span> <span class="st">&#39;https://unpkg.com/php-wasm-sqlite/php8.3-sqlite.so&#39;</span><span class="op">,</span> <span class="dt">ini</span><span class="op">:</span> <span class="kw">true</span>  }<span class="op">,</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    { <span class="dt">url</span><span class="op">:</span> <span class="st">&#39;https://unpkg.com/php-wasm-sqlite/sqlite.so&#39;</span><span class="op">,</span>        <span class="dt">ini</span><span class="op">:</span> <span class="kw">false</span> }<span class="op">,</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>]})<span class="op">;</span></span></code></pre></div>
<h3 id="loading-dynamic-extensions-as-js-modules">Loading Dynamic
Extensions as JS Modules:</h3>
<p>Dynamic extensions can be loaded as modules: So long as the main file
of the module defines the <code>getLibs</code> and <code>getFiles</code>
methods, extensions may be loaded like so:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">new</span> <span class="fu">PhpNode</span>({<span class="dt">sharedLibs</span><span class="op">:</span>[ <span class="cf">await</span> <span class="im">import</span>(<span class="st">&#39;php-wasm-intl&#39;</span>) ]})</span></code></pre></div>
<p>Dynamic extensions can also be loaded as modules from any static HTTP
server with an ESM directory structure.</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">// This will load both sqlite.so &amp; php8.x-sqlite.so:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">sharedLibs</span><span class="op">:</span> [ <span class="cf">await</span> <span class="im">import</span>(<span class="st">&#39;https://cdn.jsdelivr.net/npm/php-wasm-sqlite&#39;</span>) ]})<span class="op">;</span></span></code></pre></div>
<p>Sadly, this notation is not available for Service Workers, since they
do not yet support dynamic <code>imports()</code>. Hopefully this will
change soon.</p>
<h3 id="compiling-extensions">Compiling extensions</h3>
<p>Extensions may be compiled as <code>dynamic</code>,
<code>shared</code>, or <code>static</code>. See
<code>Custom Builds</code> for more information on compiling
php-wasm.</p>
<ul>
<li>dynamic - these extensions may be loaded selectively at
runtime.</li>
<li>shared - these extensions will always be loaded at startup and can
be cached and reused.</li>
<li>static - these extensions will be built directly into the main wasm
binary (may cause a huge filesize).</li>
</ul>
<h2 id="loading-files">📦 Loading Files</h2>
<h3 id="loading-single-files-at-runtime">Loading single files at
runtime</h3>
<p>When spawning a new instance of PHP, a <code>files</code> array can
be provided to be loaded into the filesystem. For example, the
<code>php-intl</code> extension requires us to load
<code>icudt72l.dat</code> into the <code>/preload</code> directory.</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> sharedLibs <span class="op">=</span> [<span class="vs">`https://unpkg.com/php-wasm-intl/php</span><span class="sc">\$</span><span class="vs">{PHP_VERSION}-intl.so`</span>]<span class="op">;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> files <span class="op">=</span> [</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;icudt72l.dat&#39;</span><span class="op">,</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">parent</span><span class="op">:</span> <span class="st">&#39;/preload/&#39;</span><span class="op">,</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">url</span><span class="op">:</span> <span class="st">&#39;https://unpkg.com/php-wasm-intl/icudt72l.dat&#39;</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>]<span class="op">;</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({sharedLibs<span class="op">,</span> files})<span class="op">;</span></span></code></pre></div>
<h3 id="preloaded-fs">Preloaded FS</h3>
<p>Use the <code>PRELOAD_ASSETS</code> key in your
<code>.php-wasm-rc</code> file to define a list of files and directories
to include by default.</p>
<p>The files and directories will be collected into a single directory.
Individual files &amp; directories will appear in the top level, while
directories will maintain their internal structure.</p>
<p>These files &amp; directories will be available under
<code>/preload</code> in the final package, packaged into the
<code>.data</code> file that is built along with the <code>.wasm</code>
file.</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="va">PRELOAD_ASSETS</span><span class="op">=</span><span class="st">&#39;/path/to/file.txt /some/directory /path/to/other_file.txt /some/other/directory&#39;</span></span></code></pre></div>
<h3 id="locatefile">locateFile</h3>
<p>You can provide the <code>locateFile</code> option to php-wasm as a
callback to map the names of files to URLs where they’re loaded from.
<code>undefined</code> can be returned as a fallback to default.</p>
<p>You can use this if your static assets are served from a different
directory than your javascript.</p>
<p>This applies to <code>.wasm</code> files, shared libraries, single
files and preloaded FS packages in <code>.data</code> files.</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">locateFile</span><span class="op">:</span> filename <span class="kw">=&gt;</span> <span class="vs">`/my/static/path/</span><span class="sc">${</span>filename<span class="sc">}</span><span class="vs">`</span>})<span class="op">;</span></span></code></pre></div>
<h2 id="persistent-storage-idbfs-nodefs">💾 Persistent Storage (IDBFS
&amp; NodeFS)</h2>
<h3 id="idbfs-web-worker">IDBFS (Web &amp; Worker)</h3>
<p>To use IDBFS in PhpWeb, pass a <code>persist</code> object with a
<code>mountPath</code> key.</p>
<p><code>mountPath</code> will be used as the path to the persistent
directory within the PHP environment.</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { PhpWeb } <span class="op">=</span> <span class="cf">await</span> <span class="im">import</span>(<span class="st">&#39;https://cdn.jsdelivr.net/npm/php-wasm/PhpWeb.mjs&#39;</span>)<span class="op">;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpWeb</span>({<span class="dt">persist</span><span class="op">:</span> {<span class="dt">mountPath</span><span class="op">:</span> <span class="st">&#39;/persist&#39;</span>}})<span class="op">;</span></span></code></pre></div>
<h3 id="nodefs-nodejs-only">NodeFS (NodeJS Only)</h3>
<p>To use NodeFS in PhpWeb, pass a <code>persist</code> object with
<code>mountPath</code> &amp; <code>localPath</code> keys.</p>
<p><code>localPath</code> will be used as the path to the HOST directory
to expose to PHP. <code>mountPath</code> will be used as the path to the
persistent directory within the PHP environment.</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> { PhpNode } <span class="op">=</span> <span class="cf">await</span> <span class="im">import</span>(<span class="st">&#39;https://cdn.jsdelivr.net/npm/php-wasm/PhpNode.mjs&#39;</span>)<span class="op">;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> php <span class="op">=</span> <span class="kw">new</span> <span class="fu">PhpNode</span>({<span class="dt">persist</span><span class="op">:</span> {<span class="dt">mountPath</span><span class="op">:</span> <span class="st">&#39;/persist&#39;</span><span class="op">,</span> <span class="dt">localPath</span><span class="op">:</span> <span class="st">&#39;~/your-files&#39;</span>}})<span class="op">;</span></span></code></pre></div>
<h2 id="filesystem-operations">📁 Filesystem Operations</h2>
<h3 id="filesystem-methods">Filesystem Methods</h3>
<p>The following EmscriptenFS methods are exposed via the php
object:</p>
<p><strong><em>Note:</em></strong> If you’re using php-web in
conjunction with php-cgi-worker to work on the filesystem, you’ll need
to <code>refresh</code> the filesystem in the worker. You can do that
with the following call using <code>msg-bus</code> (see below).</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Tell the worker that the FS has been updated</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> <span class="fu">sendMessage</span>(<span class="st">&#39;refresh&#39;</span>)<span class="op">;</span></span></code></pre></div>
<h4 id="php.analyzepath">php.analyzePath</h4>
<p>Get information about a file or directory.</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">analyzePath</span>(path)<span class="op">;</span></span></code></pre></div>
<h4 id="php.readdir">php.readdir</h4>
<p>Get a list of files and folders in or directory.</p>
<div class="sourceCode" id="cb44"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">readdir</span>(path)<span class="op">;</span></span></code></pre></div>
<h4 id="php.readfile">php.readFile</h4>
<p>Get the content of a file as a <code>Uint8Array</code> by default, or
optionally as utf-8.</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">readFile</span>(path)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">readFile</span>(path<span class="op">,</span> {<span class="dt">encoding</span><span class="op">:</span> <span class="st">&#39;utf8&#39;</span>})<span class="op">;</span></span></code></pre></div>
<h4 id="php.stat">php.stat</h4>
<p>Get information about a file or directory.</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">stat</span>(path)<span class="op">;</span></span></code></pre></div>
<h4 id="php.mkdir">php.mkdir</h4>
<p>Create a directory.</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">mkdir</span>(path)<span class="op">;</span></span></code></pre></div>
<h4 id="php.rmdir">php.rmdir</h4>
<p>Delete a directory (must be empty).</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">rmdir</span>(path)<span class="op">;</span></span></code></pre></div>
<h4 id="php.unlink">php.unlink</h4>
<p>Delete a file.</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">rmdir</span>(path)<span class="op">;</span></span></code></pre></div>
<h4 id="php.rename">php.rename</h4>
<p>Rename a file or directory.</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">rename</span>(path<span class="op">,</span> newPath)<span class="op">;</span></span></code></pre></div>
<h4 id="php.writefile">php.writeFile</h4>
<p>Create a new file. Content should be supplied as a
<code>Uint8Array</code>, or optionally as a string of text.</p>
<div class="sourceCode" id="cb52"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">writeFile</span>(path<span class="op">,</span> data)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">writeFile</span>(path<span class="op">,</span> data<span class="op">,</span> {<span class="dt">encoding</span><span class="op">:</span> <span class="st">&#39;utf8&#39;</span>})<span class="op">;</span></span></code></pre></div>
<h3 id="transactions">Transactions</h3>
<p><strong>Web and Worker only!</strong></p>
<p>The web and worker build use <code>navigator.locks.request</code> to
request a lock named <code>php-wasm-fs-lock</code> before performing
filesystem operations. This ensure multiple tabs &amp; the service
worker can interact with the filesystem without overwriting eachother’s
work. Before any FS operation takes place, the entire FS is loaded from
IDBFS, and before the lock is released, the entire FS is laoded BACK
into IDBFS.</p>
<p>The operations are enqueued asyncronously, <strong>so if multiple
requests are generated before one transaction closes, they will be
batched automatically.</strong> This also applies to multiple requests
generated before the lock is acquired. There is generally no need to
take explicit control of FS mirroring.</p>
<p>To suppress this behavior and take explicit control of the FS
mirroring, you can pass the <code>{autoTransaction: false}</code> option
to the constructor. Doing this will require you to call
<code>php.startTransaction()</code> before any FS operations take place,
and then<code>php.commitTransaction()</code> when you’re done.
<strong>Using this incorrectly may leave your filesystem in a corrupted
state.</strong></p>
<h4 id="php.starttransaction">php.startTransaction</h4>
<div class="sourceCode" id="cb54"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">startTransaction</span>()<span class="op">;</span></span></code></pre></div>
<h4 id="php.committransaction">php.commitTransaction</h4>
<div class="sourceCode" id="cb55"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="cf">await</span> php<span class="op">.</span><span class="fu">commitTransaction</span>()<span class="op">;</span></span></code></pre></div>
<h3 id="msg-bus">msg-bus</h3>
<p>There is a <code>msg-bus</code> module supplied by
<code>php-cgi-wasm</code> as a helper to communicate with php running
inside a worker. The module exposes two functions:
<code>sendMessageFor</code> and <code>onMessage</code>.</p>
<p>This allows you to simply <code>await</code> the result of calls to
file system methods (see above) on the service worker:</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="fu">sendMessage</span>(methodName<span class="op">,</span> [param<span class="op">,</span> param<span class="op">,</span> param])<span class="op">;</span></span></code></pre></div>
<h4 id="onmessage-sendmessagefor">onMessage &amp; sendMessageFor</h4>
<ul>
<li>Use <code>onMessage</code> as an event handler for
<code>message</code> events coming from the Service Worker.</li>
<li>Use <code>sendMessageFor</code> to <strong>GENERATE A
FUNCTION</strong> that you can use to send messages to your service
worker.</li>
</ul>
<div class="sourceCode" id="cb57"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { onMessage<span class="op">,</span> sendMessageFor } <span class="im">from</span> <span class="vs">`php-cgi-wasm/msg-bus`</span><span class="op">;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> SERVICE_WORKER_SCRIPT_URL <span class="op">=</span> <span class="st">&#39;/cgi-worker.mjs&#39;</span><span class="op">;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="bu">navigator</span><span class="op">.</span><span class="at">serviceWorker</span><span class="op">.</span><span class="fu">register</span>(SERVICE_WORKER_SCRIPT_URL)<span class="op">;</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="bu">navigator</span><span class="op">.</span><span class="at">serviceWorker</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;message&#39;</span><span class="op">,</span> onMessage)<span class="op">;</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> sendMessage <span class="op">=</span> <span class="fu">sendMessageFor</span>(SERVICE_WORKER_SCRIPT_URL)<span class="op">;</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="fu">sendMessage</span>(methodName<span class="op">,</span> [param<span class="op">,</span> param<span class="op">,</span> param])<span class="op">;</span></span></code></pre></div>
<h4 id="php.handlemessageevent">php.handleMessageEvent</h4>
<p>Once you’ve got the above set up, use
<code>php.handleMessageEvent</code> to handle the <code>message</code>
events on the service worker:</p>
<div class="sourceCode" id="cb58"><pre
class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>self<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;message&#39;</span><span class="op">,</span>  <span class="bu">event</span> <span class="kw">=&gt;</span> php<span class="op">.</span><span class="fu">handleMessageEvent</span>(<span class="bu">event</span>))<span class="op">;</span></span></code></pre></div>
<h2 id="custom-builds">🏗️ Custom Builds</h2>
<p>To use the the in-place builder, first install
<code>php-wasm-builder</code> globally:</p>
<p><strong><em>Requires docker, docker-compose, coreutils, wget, &amp;
make.</em></strong></p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> npm install <span class="at">-g</span> php-wasm-builder</span></code></pre></div>
<p>Create the build environment (can be run from anywhere):</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> php-wasm-builder image</span></code></pre></div>
<p>Optionally clean up files from a previous build:</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> php-wasm-builder clean</span></code></pre></div>
<h3 id="build-for-web">Build for web</h3>
<p>Then navigate to the directory you want the files to be built in, and
run <code>php-wasm-builder build</code></p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd ~/my-project</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> php-wasm-builder build</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># php-wasm-builder build web</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  &quot;web&quot; is the default here</span></span></code></pre></div>
<h3 id="build-for-node">Build for node</h3>
<div class="sourceCode" id="cb63"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> cd ~/my-project</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> php-wasm-builder build node</span></code></pre></div>
<h3 id="esm-modules">ESM Modules:</h3>
<p>Build ESM modules with:</p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> php-wasm-builder build web mjs</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> php-wasm-builder build node mjs</span></code></pre></div>
<h3 id="cgi-modules">CGI Modules:</h3>
<p>Build CGI modules with:</p>
<div class="sourceCode" id="cb65"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> php-wasm-builder build web cgi mjs</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> php-wasm-builder build worker cgi mjs</span></code></pre></div>
<p>This will build the package inside of the current directory (or in
<code>PHP_DIST_DIR</code>, <em>see below for more info.</em>)</p>
<h3 id="php-wasm-rc">.php-wasm-rc</h3>
<p>You can also create a <code>.php-wasm-rc</code> file in this
directory to customize the build.</p>
<pre class="make"><code># Select a PHP version
PHP_VERSION=8.3

# Build the package to a directory other than the current one (RELATIVE path)
PHP_DIST_DIR=./public

# Build the extensions to a directory other than the current one (RELATIVE path)
PHP_ASSET_DIR=./public


# Build the cgi package to a directory other than the current one (RELATIVE path)
PHP_CGI_DIST_DIR=./public

# Build the cgi package&#39;s extensions to a directory other than the current one (RELATIVE path)
PHP_CGI_ASSET_DIR=./public

# Space separated list of files/directories (ABSOLUTE paths)
# to be included under the /preload directory in the final build.
PRELOAD_ASSETS=~/my-project/php-scripts ~/other-dir/example.php

# Memory to start the instance with, before growth
INITIAL_MEMORY=2048MB

# Build with assertions enabled
ASSERTIONS=0

# Select the optimization level
OPTIMIZATION=3

# Build with extensions
WITH_GD=1
WITH_LIBPNG=1
WITH_LIBJPEG=1
WITH_FREETYPE=1</code></pre>
<h4 id="options">Options</h4>
<p>The following options may appear in <code>.php-wasm-rc</code>.</p>
<hr />
<h5 id="php_version">PHP_VERSION</h5>
<p>8.0|8.1|8.2|<strong>8.3</strong></p>
<hr />
<h5 id="php_dist_dir">PHP_DIST_DIR</h5>
<p>This is the directory where javascript &amp; wasm files will be built
to, <em>relative to the current directory.</em></p>
<hr />
<h5 id="php_asset_dir">PHP_ASSET_DIR</h5>
<p>This is the directory where shared libs, extension,
<code>.data</code> files &amp; other supporting files will be built to,
<em>relative to the current directory.</em> Defaults to
<code>PHP_DIST_DIR</code>.</p>
<hr />
<h5 id="optimize">OPTIMIZE</h5>
<p>0|1|2|<strong>3</strong></p>
<p>The optimization level to use while compiling.</p>
<hr />
<h5 id="suboptimize">SUBOPTIMIZE</h5>
<p>The optimization level to use while compiling libraries. Defaults to
<code>OPTIMIZE</code>.</p>
<hr />
<h5 id="preload_assets">PRELOAD_ASSETS</h5>
<p>A list of <strong>absolute paths</strong> to files &amp; directories
to build to the <code>/preload</code> directory. Will produce a
<code>.data</code> file.</p>
<hr />
<h5 id="assertions">ASSERTIONS</h5>
<p>0|<strong>1</strong></p>
<p>Build with/without assertions.</p>
<hr />
<h4 id="extensions-1">Extensions</h4>
<p>As stated above, extensions may be compiled as <code>dynamic</code>,
<code>shared</code>, or <code>static</code>.</p>
<ul>
<li>dynamic - these extensions may be loaded selectively at
runtime.</li>
<li>shared - these extensions will always be loaded at startup and can
be cached and reused.</li>
<li>static - these extensions will be built directly into the main wasm
binary (may cause a huge filesize).</li>
</ul>
<p>(defaults provided below in <strong>bold</strong>)</p>
<p>The following options are availavle for building static PHP
extensions:</p>
<pre><code>WITH_BCMATH    # [0, 1] Enabled by default
WITH_CALENDAR  # [0, 1] Enabled by default
WITH_CTYPE     # [0, 1] Enabled by default
WITH_EXIF      # [0, 1] Enabled by default
WITH_FILTER    # [0, 1] Enabled by default
WITH_TOKENIZER # [0, 1] Enabled by default
WITH_VRZNO     # [0, 1] Enabled by default</code></pre>
<p>The following extension may be compiled as static, shared or
dynamic:</p>
<pre><code>WITH_PHAR      # [0, 1, static, dynamic]
WITH_LIBXML    # [0, 1, static, shared]
WITH_ICONV     # [0, 1, static, shared, dynamic]
WITH_SQLITE    # [0, 1, static, shared, dynamic]

WITH_LIBZIP    # [0, 1, static, shared, dynamic]
WITH_ZLIB      # [0, 1, static, shared, dynamic]

WITH_GD        # [0, 1, static, shared, dynamic]
WITH_LIBPNG    # [0, 1, static, shared]
WITH_FREETYPE  # [0, 1, static, shared]
WITH_LIBJPEG   # [0, 1, static, shared]

WITH_YAML      # [0, 1, static, shared, dynamic]
WITH_TIDY      # [0, 1, static, shared, dynamic]
WITH_MBSTRING  # [0, 1, static, dynamic]
WITH_ONIGURUMA # [0, 1, static, shared]
WITH_OPENSSL   # [0, 1, shared, dynamic]
WITH_INTL      # [0, 1, static, shared, dynamic]</code></pre>
<hr />
<h5 id="with_phar">WITH_PHAR</h5>
<p>static|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension file <code>php8.x-phar.so</code>.</p>
<hr />
<h5 id="with_libxml">WITH_LIBXML</h5>
<p>static|<strong>shared</strong></p>
<p>This actual <code>php-libxml</code> extension must be statically
compiled, but <code>libxml</code> itself may be loaded as a shared
library.</p>
<p>When compiled as a <code>shared</code> library, it will produce the
library <code>libxml.so</code>.</p>
<hr />
<h5 id="with_libzip">WITH_LIBZIP</h5>
<p>static|shared|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension <code>php-8.x-zip.so</code>.</p>
<p>When compiled as a <code>dynamic</code> or <code>shared</code>
extension, it will produce the library <code>libzip.so</code>.</p>
<p>This extension depends on <code>zlib</code>.</p>
<hr />
<h5 id="with_iconv">WITH_ICONV</h5>
<p>static|shared|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension <code>php-8.x-iconv.so</code>.</p>
<p>When compiled as a <code>dynamic</code> or <code>shared</code>
extension, it will produce the library <code>libiconv.so</code>.</p>
<hr />
<h5 id="with_sqlite">WITH_SQLITE</h5>
<p>static|shared|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extensions <code>php-8.x-sqlite.so</code>, &amp;
<code>php-8.x-pdo-sqlite.so</code>.</p>
<p>When compiled as a <code>dynamic</code> or <code>shared</code>
extension, it will produce the library <code>libsqlite3.so</code>.</p>
<hr />
<h5 id="with_gd">WITH_GD</h5>
<p>static|<strong>dynamic</strong></p>
<p>This extenstion makes use of <code>freetype</code>,
<code>libjpeg</code>, <code>libpng</code>, &amp; <code>zlib</code>.</p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension <code>php-8.x-gd.so</code>.</p>
<h6 id="with_libpng">WITH_LIBPNG</h6>
<p>static|<strong>shared</strong></p>
<p>When compiled as a <code>shared</code> library, this will produce the
library <code>libpng.so</code>.</p>
<p>If WITH_GD is dynamic, then loading will be deferred until after gd
is loaded.</p>
<h6 id="with_freetype">WITH_FREETYPE</h6>
<p>static|<strong>shared</strong></p>
<p>When compiled as a <code>shared</code> library, this will produce the
library <code>libfreetype.so</code>.</p>
<p>If WITH_GD is dynamic, then loading will be deferred until after gd
is loaded.</p>
<h6 id="with_libjpeg">WITH_LIBJPEG</h6>
<p>static|<strong>shared</strong></p>
<p>When compiled as a <code>shared</code> library, this will produce the
library <code>libjpeg.so</code>.</p>
<p>If WITH_GD is dynamic, then loading will be deferred until after gd
is loaded.</p>
<hr />
<h5 id="with_zlib">WITH_ZLIB</h5>
<p>static|shared|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension <code>php-8.x-zlib.so</code>.</p>
<p>When compiled as a <code>dynamic</code> or <code>shared</code>
extension, it will produce the library <code>libz.so</code>.</p>
<hr />
<h5 id="with_yaml">WITH_YAML</h5>
<p>static|shared|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension <code>php-8.x-yaml.so</code>.</p>
<p>When compiled as a <code>dynamic</code> or <code>shared</code>
extension, it will produce the library <code>libyaml.so</code>.</p>
<hr />
<h5 id="with_tidy">WITH_TIDY</h5>
<p>static|shared|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension <code>php-8.x-tidy.so</code>.</p>
<p>When compiled as a <code>dynamic</code> or <code>shared</code>
extension, it will produce the library <code>libtidy.so</code>.</p>
<hr />
<h5 id="with_mbstring">WITH_MBSTRING</h5>
<p>static|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension <code>php-8.x-mbstring.so</code>.</p>
<hr />
<h5 id="with_oniguruma">WITH_ONIGURUMA</h5>
<p>static|shared|<strong>dynamic</strong></p>
<p>Support library for <code>mbstring</code>.</p>
<p>When compiled as a <code>dynamic</code> or <code>shared</code>
library, this will produce the library <code>libonig.so</code>.</p>
<p>If <code>WITH_MBSTRING</code> is <code>dynamic</code>, then loading
will be deferred until after <code>mbstring</code> is loaded.</p>
<hr />
<h5 id="with_openssl">WITH_OPENSSL</h5>
<p>shared|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code> extension, this will produce
the extension <code>php-8.x-openssl</code>.</p>
<p>When compiled as a <code>dynamic</code> or <code>shared</code>
extension, it will produce the libraries <code>libssl.so</code> &amp;
<code>libcrypto.so</code>.</p>
<h5 id="with_intl">WITH_INTL</h5>
<p>static|shared|<strong>dynamic</strong></p>
<p>When compiled as a <code>dynamic</code>, or <code>shared</code>
extension, this will produce the extension <code>php-8.x-intl.so</code>
&amp; the following libraries:</p>
<ul>
<li>libicuuc.so</li>
<li>libicutu.so</li>
<li>libicutest.so</li>
<li>libicuio.so</li>
<li>libicui18n.so</li>
<li>libicudata.so</li>
<li>icudt72l.dat</li>
</ul>
<hr />
<h3 id="php-wasm-builder-commands">php-wasm-builder commands</h3>
<h4 id="php-wasm-builder-build">php-wasm-builder build</h4>
<p>Use this to build custom version of php-wasm. Its recommended to
build this to an empty directory using a <code>.php-wasm-rc</code>
file.</p>
<div class="sourceCode" id="cb69"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> php-wasm-builder build</span></code></pre></div>
<h4 id="php-wasm-builder-image">php-wasm-builder image</h4>
<p>This will build the docker container used to build php-wasm.</p>
<div class="sourceCode" id="cb70"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> php-wasm-builder image</span></code></pre></div>
<h4 id="php-wasm-builder-copy-assets">php-wasm-builder copy-assets</h4>
<p>This will scan the current package’s node_modules directory for
shared libraries &amp; supporting files, and copy them to
<code>PHP_ASSET_DIR</code>.</p>
<p>You can use this with <code>.php-wasm-rc</code> to copy assets even
if you’re not using a custom build.</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> php-wasm-builder copy-assets</span></code></pre></div>
<h4 id="php-wasm-builder-build-assets">php-wasm-builder
build-assets</h4>
<p>Similar to <code>copy-assets</code>, but will actually compile the
shared libaries, then copy them to <code>PHP_ASSET_DIR</code>.</p>
<p>You can use this with <code>.php-wasm-rc</code> to copy assets even
if you’re not using a custom build.</p>
<div class="sourceCode" id="cb72"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> php-wasm-builder build-assets</span></code></pre></div>
<h4 id="php-wasm-builder-clean">php-wasm-builder clean</h4>
<p>Clear cached build resources.</p>
<div class="sourceCode" id="cb73"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> php-wasm-builder clean</span></code></pre></div>
<h4 id="php-wasm-builder-deep-clean">php-wasm-builder deep-clean</h4>
<p>Clear out all downloaded dependencies and start from scratch.</p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> php-wasm-builder deep-clean</span></code></pre></div>
<h4 id="php-wasm-builder-help">php-wasm-builder help</h4>
<p>Print the help text for a given command</p>
<div class="sourceCode" id="cb75"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> php-wasm-builder help COMMAND</span></code></pre></div>
<h2 id="php-wasm-started-as-a-fork-of-oraotopib">🤝 php-wasm started as
a fork of oraoto/PIB…</h2>
<p>The repository <a
href="https://github.com/seanmorris/pib-legacy">pib-legacy</a> was
created to preserve the original state of the project.</p>
<p><a href="https://github.com/oraoto/pib"
class="uri">https://github.com/oraoto/pib</a></p>
<p>The repository <code>pib-legacy</code> was created to preserve the
original state of the project: <a
href="https://github.com/seanmorris/pib-legacy"
class="uri">https://github.com/seanmorris/pib-legacy</a></p>
<h2 id="licensed-under-the-apache-license-version-2.0">🍻 Licensed under
the Apache License, Version 2.0</h2>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you
may not use this file except in compliance with the License. You may
obtain a copy of the License at</p>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0"
class="uri">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<hr />
<p><em>Special thanks to Alex Haussmann</em></p></article>
						<nav class = "table-of-contents">
				<span>on this page:</span>
				<ul>
    <li><a href="#php-wasm">php-wasm</a>
    <ul>
    <li><a href="#npm-github-unpkg-reddit-discord"><span>npm</span> |
    <span>github</span> | <span>unpkg</span> | <span>reddit</span> |
    <span>discord</span></a></li>
    <li><a href="#v0.0.9-alpha---aiming-for-the-github-stars">🌟
    v0.0.9-alpha - Aiming for the (GitHub) Stars</a></li>
    <li><a href="#examples">☀️ Examples</a>
    <ul>
    <li><a href="#react-php-webphp-cgi-worker-demo">[<span>React +
    php-web/php-cgi-worker demo</span>]</a></li>
    </ul></li>
    <li><a href="#introducing-php-cgi-wasm">🎩 Introducing
    php-cgi-wasm!</a>
    <ul>
    <li><a href="#install-the-php-cgi-wasm-package">Install the
    php-cgi-wasm package</a></li>
    <li><a href="#example-service-worker">Example Service
    Worker:</a></li>
    </ul></li>
    <li><a href="#install-use">🛠️ Install &amp; Use</a>
    <ul>
    <li><a href="#common-js">Common JS</a></li>
    <li><a href="#esm">ESM</a></li>
    </ul></li>
    <li><a href="#quickstart">🍎 Quickstart</a>
    <ul>
    <li><a href="#inline-php">Inline PHP</a></li>
    </ul></li>
    <li><a href="#running-php-taking-output">🥤 Running PHP &amp; Taking
    Output</a>
    <ul>
    <li><a href="#dynamic-extensions-in-static-pages">Dynamic Extensions
    in Static Pages</a></li>
    </ul></li>
    <li><a href="#configuration">⚙️ Configuration</a>
    <ul>
    <li><a href="#cgi-configuration">CGI Configuration</a></li>
    <li><a href="#writing-an-ini-for-multiple-php-versions">Writing an
    INI for multiple PHP versions</a></li>
    </ul></li>
    <li><a href="#extensions">🔌 Extensions</a>
    <ul>
    <li><a href="#loading-extensions-at-runtime">Loading extensions at
    runtime</a></li>
    <li><a href="#dynamic-extensions-from-remote-servers">Dynamic
    Extensions from Remote Servers:</a></li>
    <li><a href="#loading-dynamic-extensions-as-js-modules">Loading
    Dynamic Extensions as JS Modules:</a></li>
    <li><a href="#compiling-extensions">Compiling extensions</a></li>
    </ul></li>
    <li><a href="#loading-files">📦 Loading Files</a>
    <ul>
    <li><a href="#loading-single-files-at-runtime">Loading single files
    at runtime</a></li>
    <li><a href="#preloaded-fs">Preloaded FS</a></li>
    <li><a href="#locatefile">locateFile</a></li>
    </ul></li>
    <li><a href="#persistent-storage-idbfs-nodefs">💾 Persistent Storage
    (IDBFS &amp; NodeFS)</a>
    <ul>
    <li><a href="#idbfs-web-worker">IDBFS (Web &amp; Worker)</a></li>
    <li><a href="#nodefs-nodejs-only">NodeFS (NodeJS Only)</a></li>
    </ul></li>
    <li><a href="#filesystem-operations">📁 Filesystem Operations</a>
    <ul>
    <li><a href="#filesystem-methods">Filesystem Methods</a></li>
    <li><a href="#transactions">Transactions</a></li>
    <li><a href="#msg-bus">msg-bus</a></li>
    </ul></li>
    <li><a href="#custom-builds">🏗️ Custom Builds</a>
    <ul>
    <li><a href="#build-for-web">Build for web</a></li>
    <li><a href="#build-for-node">Build for node</a></li>
    <li><a href="#esm-modules">ESM Modules:</a></li>
    <li><a href="#cgi-modules">CGI Modules:</a></li>
    <li><a href="#php-wasm-rc">.php-wasm-rc</a></li>
    <li><a href="#php-wasm-builder-commands">php-wasm-builder
    commands</a></li>
    </ul></li>
    <li><a href="#php-wasm-started-as-a-fork-of-oraotopib">🤝 php-wasm
    started as a fork of oraoto/PIB…</a></li>
    <li><a href="#licensed-under-the-apache-license-version-2.0">🍻
    Licensed under the Apache License, Version 2.0</a></li>
    </ul></li>
    </ul>
				<span><a href = "#">top</a></span>
			</nav>
					</div>
	</section>

	<footer class="footer">
		<h3>PHP WASM</h3>

		<h4>Resources</h4>
		<ul>
			<li><a href="https://github.com/seanmorris/php-wasm/issues">Issue Tracker</a></li>
			<li><a href="https://github.com/seanmorris/php-wasm/discussions">GitHub Discussions</a></li>
		</ul>

		<h4>Contact</h4>
		<ul>
			<li><a href = "https://github.com/sponsors/seanmorris">Sponsor</a></li>
			<li><a href="https://github.com/seanmorris/php-wasm">Github</a></li>
			<li><a href="https://discord.com/invite/j8VZzju7gJ">Discord</a></li>
		</ul>

		<h4>About</h4>
		<p><a href="http://localhost:8081/LICENSE.html">License</a></p>
		<p>&copy; 2024 Sean Morris</p>
		<p>This site is rendered with PHP + Pandoc.</p>

	</footer>
</body>
